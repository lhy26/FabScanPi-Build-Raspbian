dist: trusty
before_install:
- sudo apt-get -qq update
- sudo apt-get -qq -y install binfmt-support qemu qemu-user-static debootstrap kpartx
  lvm2 dosfstools apt-cacher-ng parted
script:
- sudo ./raspbian/build_raspbian_sd_card.sh
before_deploy:
- export RELEASE_FILE_NAME=$(ls ${HOME}/build/${TRAVIS_REPO_SLUG}/rpi/images/fabscanpi_basic_jessie_*.img)
- export MD5=$(md5sum ${RELEASE_FILE_NAME} | cut -d ' ' -f 1)
- export SHA1=$(sha1sum ${RELEASE_FILE_NAME} | cut -d ' ' -f 1)
- touch MD5:"${MD5}"
- touch SHA1:"${SHA1}"
- echo "deploying $RELEASE_FILE_NAME to GitHub releases"
deploy:
  file_glob: true
  provider: releases
  skip_cleanup: true
  api_key:
    secure: "PGm6IAALJ7i/jx4kdQcOGv/lDx6ib14NJIh4bVRaF5f7XjNex621sH/Aca0RQ0JN4sddP4NHH/b5vWeEcR6ktFND98W89n5YNYt/9PMHMDVN1Bizr/rmApy3tcTnvrcg2hgllCfQVN2zVhwyrS9RM5B29jCyrzYVuq7zBwLG4dY2zTMHJREYtAs+E2+XQ4fS8hRN7JtLCcWbFfmRj0TaK/ymXAoMB7En/v3dLrUtgmCs39G6jPBY3u+ry6UVxVJM6XnE2BmlKNp9TNgTi7HfzrZwAVfLyqEnDg/q68I9paUxrdSyY22FrCH0DYmnAglpSBfhJ6TW+CYxanqlHiDTYkvWyDJx1HwZfDvodgkZFbeo/gLyZK3ZDFINpa6TP7miUK8gjY+Sq12se+LpIPBi/+sZAQEObHlvdTtMtQmv4NR2b6qWqLiivZtcAtF/GiK0Eqoh5jGqcwB49Lqq8Awrjpn1wty8rqRBNjNF7lvYd0BygXgXctos8aKGCAh/GM3F/488XE2eIEUPyRdr5DWvmdFccR09muGnssNlSZcpNNWhGMHeaePzv+nuvjl6E0w3dx3yrBlbddQNlwrqYe85THNpUMYMoC4pPx4aS48PReF9jVbqSyZGBZ8yHePxwmINNEv6UHqpRVNNcwAr9e5sGe+tpmIBe5pqmGoEmi9tAOo="
  file:
  - "${RELEASE_FILE_NAME}"
  - MD5:${MD5}
  - SHA1:${SHA1}
  on:
    tags: true
